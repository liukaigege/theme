<style>
  #recommend-section_layui_swiper h3 {
    font-size: .16rem;
    /* font-family: Floane-Regular, Floane; */
    font-family: Arial;
    font-weight: 400;
    color: #363636;
    text-align: center;
    margin-bottom: .15rem;
    margin-top: .2rem;
    text-transform: capitalize;
  }

  #recommend-section_layui_swiper .swiper-slide {
    width: 1.64rem !important;
    text-align: center;
    background: #FFFFFF;
    box-shadow: 0px 2px 15px 0px rgba(0, 0, 0, 0.07);
    border-radius: 1px;
  }

  #recommend-section_layui_swiper .swiper-slide a {
    width: 100%;
    display: block;
  }

  #recommend-section_layui_swiper .cover_wrap {
    width: 100%;
    padding-bottom: 100% !important;
    position: relative;
    margin: 0 auto;
    overflow: hidden;
  }

  #recommend-section_layui_swiper .cover {
    -o-object-fit: contain;
    object-fit: contain;
    position: absolute;
    width: auto;
    height: auto;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    max-width: 100%;
    max-height: 100%;
  }

  #recommend-section_layui_swiper .m_title {
    font-size: 0.1rem;
    /* font-family: "Floane-Regular"; */
    font-family: Arial;
    color: #303133;
    padding: 0 0.06rem;
    line-height: 2;
    padding-top: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-align: center;
  }

  #recommend-section_layui_swiper .price {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    line-height: 1;
    padding-bottom: 0.05rem;
    height: .3rem;
  }

  #recommend-section_layui_swiper .now_price {
    font-size: 0.12rem;
    font-family: "Aileron-SemiBold, Aileron";
    font-weight: 600;
    color: #000000;
    padding: 0 0 0.04rem;
    line-height: 1;
  }

  #recommend-section_layui_swiper .old_price {
    font-size: 0.1rem;
    font-family: "Aileron-Regular, Aileron";
    font-weight: 400;
    color: #9B9B9B;
    line-height: 1;
    text-decoration: line-through;
    position: relative;
    top: -0.02rem;
  }

  #recommend-section_layui_swiper .old_price+.now_price {
    padding-left: 0.05rem !important;

  }

  #recommend-section_layui_swiper .swiper-container {
    padding-bottom: 0.16rem;
  }

  .product_red.row .m_title {
    font-size: 0.2rem;
  }

  .product_red.row .old_price,
  .product_red.row .now_price {
    font-size: 0.2rem;
  }

  .product_red.row .now_price .hide {
    display: none;
  }

  #recommend-section_layui_swiper .free_shipping {
    z-index: 1;
    left: 0;
    bottom: 0;
    background: #DF0052;
    border-radius: 0px 0px 0px 1px;
    font-weight: bold;
    font-size: 0.1rem;
    font-family: "Aileron-Bold, Aileron";
    color: #FFFFFF;
    line-height: 1;
    padding: 0.02rem;
    margin-bottom: 0.05rem;
  }

  #recommend-section_layui_swiper .off em {
    font-style: normal;
  }

  #recommend-section_layui_swiper .off {
    color: #ffffff;
    flex-wrap: wrap;
    right: 0.06rem;
    top: 0.06rem;
    text-align: center;
    overflow: hidden;
    z-index: 2;
    background: #df0052;
    display: inline-block;
    padding: 0.02rem 0.04rem 0;
  }

  #recommend-section_layui_swiper .off em:first-child {
    font-size: 0.12rem;
    font-family: Aileron-Bold, Aileron;
    display: inline-block;
    line-height: 1;
  }

  #recommend-section_layui_swiper .off em:first-child i {
    font-weight: bold;
  }

  #recommend-section_layui_swiper .off em:last-child {
    font-size: 0.1rem;
    font-family: Aileron-Bold, Aileron;
  }

  .discount_wrap {
    position: absolute;
    top: .1rem;
    right: 0;
    z-index: 99;
  }
</style>
<div id="recommend-section_layui_swiper">
  {% if isShow %}
  <h3>you may also like </h3>
  {% endif %}
  <div class="swiper-container newProducts_details" id='recommend_layui_swiper'>

  </div>
</div>
{% raw %}
<script id='recommend_template' type="text/html">
    <div class="swiper-wrapper">
      {{#  layui.each(d, function(index, item){ }}
      <div class="swiper-slide">
        <a href="productDetail_{{item.id}}.html">
          <div class="cover_wrap">
            <div class="discount_wrap">
{{# if(item.freeShipping != 0){ }}
<div class="free_shipping">
  FREE SHIPPING
</div>
{{# } }}
{{# if(item.defaultPrice && item.defaultPrice < item.originalPrice){ }} <div class="off">
  <em><i></i>%</em>
  <em>OFF</em>
  </div>
  {{# } }}
            </div>
            
            
            <img class="cover" data-suffix-img="{{item.mainImg}}">
          </div>
          <p class="m_title">{{item.goodsName}}</p>
          <div class="price" data-price="{{item.defaultPrice}}" data-originalPrice='{{item.originalPrice}}'>
            <span class="old_price hide"></span>
            <span class="now_price"></span>
          </div>
        </a>
        {{# if (item.speType==3) { }}
          <div class="wrapContainer">
              <div class="cube">
                  <div class="cubeList front">3</div>
                  <div class="cubeList back">3</div>
                  <div class="cubeList top">3</div>
                  <div class="cubeList bottom">D</div>
                  <div class="cubeList left">D</div>
                  <div class="cubeList right">D</div>
              </div>
          </div>
          {{# } }}
      </div>
      {{# }) }}
    </div>

</script>
{% endraw %}
<script type="text/javascript">
  $(function () {
    var result = [];
    // let version_rec = new Date().getTime()
    // $.getJSON("../data/detail.json?version=" + version_rec, function (data) {
    var data = deepClone(DETAILDATA)
    var data_length = data.length > 100 ? 100 : data.length;
    var ranNum = data_length > 12 ? 12 : data_length;
    for (var i = 0; i < ranNum; i++) {
      var ran = Math.floor(Math.random() * (data_length - i));
      result.push(data[ran]);
      data[ran] = data[data_length - i - 1];
    };
    layui.use(['laytpl'], function () {
      let laytpl = layui.laytpl;
      let getTpl = recommend_cart_template.innerHTML,
        view = document.getElementById('recommend_layui_swiper');
      laytpl(getTpl).render(result, function (html) {
        view.innerHTML = html;
        // newProducts 下的轮播图
        var recommend_cart_layui_swiper = new Swiper('#recommend_layui_swiper', {
          observer: true,//修改swiper自己或子元素时，自动初始化swiper
          observeParents: true,//修改swiper的父元素时，自动初始化swiper
          slidesPerView: 'auto',
          spaceBetween: 10,
        })
        recommendLayuiSwiper();
      });
      function recommendLayuiSwiper() {

        let allprice = $("#recommend_layui_swiper [p-price]")
        allprice.each(function (index) {
          $(this).text(getMoney($(this).attr('p-price')))
        });
      }
      let price = $('#recommend_layui_swiper .swiper-slide')
      price.each(function (index, item) {
        let $defaultPrice = $(item).find('.price').attr('data-price'),
          $originalPrice = $(item).find('.price').attr('data-originalPrice');
        relationCount($(item), $defaultPrice, $originalPrice)
      });
      /* 计算价格 */
      function relationCount($this, $defaultPrice, $originalPrice) {
        if ($originalPrice && $originalPrice != '' && Number($originalPrice) > Number($defaultPrice) && Object.prototype.toString.call($originalPrice).slice(8, -1) != 'Null') {
          $this.find('.now_price').removeClass('hide').html(getMoney($defaultPrice)).addClass('main_color');
          $this.find('.old_price').removeClass('hide').html(getMoney($originalPrice));
          $this.find('.off i').html(parseFloat(Math.floor((1 - Number($defaultPrice) / Number($originalPrice)) * 100)) || 1);
          $this.find('[data-discount]').removeClass('hide');
        } else {
          $this.find('.now_price').html(getMoney($defaultPrice))
        }
      }
    })

  })
</script>