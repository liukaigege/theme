<!-- facebook -->
{% if pointInfo.codeFacebook | fmtBoolean %}
{% assign facebookId = pointInfo.codeFacebook %}
<script type="text/javascript">
	! function (f, b, e, v, n, t, s) {
		if (f.fbq) return;
		n = f.fbq = function () {
			n.callMethod ? n.callMethod.apply(n, arguments) : n.queue.push(arguments)
		};
		if (!f._fbq) f._fbq = n;
		n.push = n;
		n.loaded = !0;
		n.version = '2.0';
		n.queue = [];
		t = b.createElement(e);
		t.async = !0;
		t.src = v;
		s = b.getElementsByTagName(e)[0];
		s.parentNode.insertBefore(t, s)
	}(window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js');
	const facebookId = '{{ facebookId }}'.split(',')
	facebookId.forEach(item => {
		fbq('init', item); // Insert your pixel ID here.
	})
	fbq('track', 'PageView');
</script>
{% assign facebookIdArr = facebookId | split: "," %}
{% for facebookIdItem in facebookIdArr %}
<noscript>
	<img height="1" width="1" style="display:none"
		src="https://www.facebook.com/tr?id={{ facebookIdItem }}&ev=PageView&noscript=1" /></noscript>
{% endfor %}
{% endif %}

<!-- codeTiktok -->
{% assign codeTiktokId = pointInfo.codeTiktok %}
{% if codeTiktokId | fmtBoolean %}
{% assign codeTiktokIdArr = codeTiktokId | split: "," %}
{% for codeTiktokIdItem in codeTiktokIdArr %}
<script type="text/javascript">
	!function (w, d, t) {
		w.TiktokAnalyticsObject = t; var ttq = w[t] = w[t] || [];
		ttq.methods = ["page", "track", "identify", "instances", "debug", "on", "off", "once", "ready", "alias", "group", "enableCookie", "disableCookie"], ttq.setAndDefer = function (t, e) { t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } }; for (var i = 0; i < ttq.methods.length; i++)ttq.setAndDefer(ttq, ttq.methods[i]); ttq.instance = function (t) { for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++)ttq.setAndDefer(e, ttq.methods[n]); return e }, ttq.load = function (e, n) { var i = "https://analytics.tiktok.com/i18n/pixel/events.js"; ttq._i = ttq._i || {}, ttq._i[e] = [], ttq._i[e]._u = i, ttq._t = ttq._t || {}, ttq._t[e] = +new Date, ttq._o = ttq._o || {}, ttq._o[e] = n || {}; var o = document.createElement("script"); o.type = "text/javascript", o.async = !0, o.src = i + "?sdkid=" + e + "&lib=" + t; var a = document.getElementsByTagName("script")[0]; a.parentNode.insertBefore(o, a) };

		ttq.load('{{codeTiktokIdItem}}');
		ttq.page();
	}(window, document, 'ttq');
	ttq.instance('{{codeTiktokIdItem}}').track('Browse')
</script>
{% endfor %}
{% endif %}

<!-- codeGoogle -->
{% if pointInfo.codeGoogle | fmtBoolean %}
{% assign googlekId = pointInfo.codeGoogle %}
<!-- Google Analytics -->
<script type="text/javascript">
		(function (i, s, o, g, r, a, m) {
			i['GoogleAnalyticsObject'] = r;
			i[r] = i[r] || function () {
				(i[r].q = i[r].q || []).push(arguments)
			}, i[r].l = 1 * new Date();
			a = s.createElement(o),
				m = s.getElementsByTagName(o)[0];
			a.async = 1;
			a.src = g;
			m.parentNode.insertBefore(a, m)
		})(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

	ga('create', '{{googlekId}}', 'auto');
	ga('send', 'pageview');
</script>
<!-- End Google Analytics -->
{% endif %}

<!-- codeHotjar -->
{% if pointInfo.codeHotjar | fmtBoolean %}
{% assign hotjarId = pointInfo.codeHotjar %}
<script type="text/javascript">
	let $hotjarId = Number('{{hotjarId}}') ? Number('{{hotjarId}}') : '{{hotjarId}}';
	(function (h, o, t, j, a, r) {
		h.hj = h.hj || function () {
			(h.hj.q = h.hj.q || []).push(arguments)
		};
		h._hjSettings = {
			hjid: $hotjarId,
			hjsv: 6
		};
		a = o.getElementsByTagName('head')[0];
		r = o.createElement('script');
		r.async = 1;
		r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
		a.appendChild(r);
	})(window, document, 'https://static.hotjar.com/c/hotjar-', '.js?sv=');
</script>
{% endif %}

{% if name == 'productDetail'%}
{% if pointInfo.codeTiktok != '' and pointInfo.tiktokType == 0%}
<script type="text/javascript">
	// tiktok像素埋点
	ttq.track('ViewContent', {
		content_id: '{{detail.id}}',
		content_type: 'product',
		content_name: "{{detail.goodsName | escape_once}}",
		quantity: 1,
		price: Number('{{detail.defaultPrice}}'),
		value: Number('{{detail.defaultPrice}}'),
		currency: 'USD',
	})
</script>
{% endif %}
{% if pointInfo.codeGoogle | fmtBoolean %}
<script type="text/javascript">
	// ga像素埋点
	ga('create', '{{pointInfo.codeGoogle}}');
	ga('require', 'ec');
	ga('ec:addProduct', {
		'id': '{{detail.id}}',
		'name': "{{detail.goodsName | escape_once}}",
		'price': Number('{{detail.defaultPrice}}'),
		'brand': "{{detail.productClassify}}",
	});
	ga('ec:setAction', 'detail');
	ga('send', 'pageview');
</script>
{% endif %}
{% endif %}
