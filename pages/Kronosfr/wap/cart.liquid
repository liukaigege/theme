{% layout 'Kronosfr/components/Kronosfr_theme' name:'cart' %}
{% block 'content' %}
{% render 'Kronosfr/components/pageHeader',configData: blockData.first,isMobilePhone: isMobilePhone,OBJ:data,isShow:true
%}

{% assign configData = data.configData %}
{% if configData.payMethod.paypal %}
{% assign paypalClientId = configData.payMethod.paypal.clientId%}
{% else %}
{% assign paypalClientId = ''%}
{% endif %}
<input type="hidden" id='paypal_clientId' data-clientId='{{paypalClientId}}'>
<!-- 空购物车 -->
<style>
  html {
    height: 100%;
    overflow: hidden;
  }

  body {
    height: 100%;
    overflow: hidden;
  }

  .cartEmpty,
  #cart {
    height: calc(100% - 0.37rem);
    box-sizing: border-box;
    overflow: auto;
  }
</style>
<div class="cartEmpty">
  <div class="cart_head">
    <span>Vous avez <i>0 article</i> dans votre panier</span>
    <i class="cart_icon--close"></i>
  </div>
  <div class="section">
    <div class="cart_empty">
      <img src="../assets/wap/images/icon/icn_basket.png" alt="">
      <p>Votre panier est vide.</p>
    </div>
  </div>
  <div class="cart_btn">
    <a href="productList.html" type="button">Continuer vos achats</a>
  </div>
  {% assign detail = data.detailData %}
  {% render 'Kronosfr/wap/components/recommend_cart_layui_swiper.liquid' data: detail, isShow: true %}
</div>
<!-- 非空购物车 -->
<div id="cart">
  <div class="cart_head">
    <span></span>
    <i class="cart_icon--close"></i>
  </div>
  <div id='cart_table'>
    <ul class="cart_list" id='cart_list'>
      <li>
        <div class="cart_del"></div>
        <div class="cart_img--mask"></div>
        <div class="cart_info">
          <div class="cart_product-name--mask"></div>
          <div class="cart_product-skuVal--mask"></div>
          <div class="cart_price--mask"></div>
        </div>
      </li>
      <li>
        <div class="cart_del"></div>
        <div class="cart_img--mask"></div>
        <div class="cart_info">
          <div class="cart_product-name--mask"></div>
          <div class="cart_product-skuVal--mask"></div>
          <div class="cart_price--mask"></div>
        </div>
      </li>
    </ul>
    <div id="back">
      <i></i>
      <a href="productList.html">Continuer vos achats</a>
    </div>
    <div id="cart-payment--info">
      <!-- 优惠卷与券码 -->
      <div class="coupon_box">
        <!-- 优惠券 -->
        <div class="cart-section new-cart-section">
          <div class="cart-section--title" data-action="toggle-collapsible"> <span>COUPON</span>
            <i></i>
          </div>
          <div class="cart-section--content">
            <div id="coupon"></div>
            <!-- 优惠卷码 -->
            <div class="cart-section cart-code">
              <div class="cart-section--title">
                <span>Avoir un code de réduction?</span>
              </div>
              <div class="cart-section--content">
                <div class="discount_code">
                  <input type="text" id="discount_code--input" placeholder="Code">
                  <button type="button" id="discount_code--btn" data-APPLIQUER="discount_code">APPLIQUER</button>
                </div>
                <p class="code_err"></p>
                <div class="history_list"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- 全场活动 -->
      <div id="promotion">
        <div class="cart-section new-cart-section">
          <div class="cart-section--title active" data-action="toggle-collapsible">
            <span>REMISE PROMOTIONNELLE</span>
            <i></i>
          </div>
        </div>
      </div>
      <!-- 运费 -->
      <div id='shipping'>
        <div class="cart-section new-cart-section">
          <div class="cart-section--title active" data-action="toggle-collapsible">
            <span>MODE DE LIVRAISON</span>
            <i></i>
          </div>
        </div>
      </div>
    </div>
    <!-- 订单数据情况 -->
    <div class="cart-section">
      <div class="cart-section--title">
        <span>SUMMARY</span>
      </div>
      <div class="cart-section--content shopcart-box" disabled>
        <div id="totalList">

        </div>
        <!-- <div id="note">
          <button type="button">
            <span>Order description</span>
            <i></i>
          </button>
          <div class="cart-recap__note-inner">
            <textarea name="cart_note" class="form__field--textarea" rows="3" autofocus=""
              id="order-note--textarea"></textarea>
          </div>
        </div> -->
        <div>
          <!-- paypal -->
          {% if paypalClientId != '' %}
          <div class="dynamic-checkout dynamic-checkout--loading">
            <div class="dynamic-checkout__skeleton">
              <div class="placeholder-line placeholder-line--animated"></div>
              <div class="placeholder-line placeholder-line--animated"></div>
            </div>
            <div class='dynamic-checkout__buttons'>
              <div id="paypal-button-container"></div>
            </div>
          </div>
          <div class="shopcart-or"><span>OU</span></div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
  <div class="cart_checkout">
    <button type="button" id="cart_checkout" data-cart="cart_btn">VÉRIFIER</button>
  </div>
</div>
</body>
{% raw %}
<script id='cart_template' type="text/html">
	{{# layui.each(d.goodsList, function(index, item){ }}
	<li data-customVal='{{$.base64.encode(item.customVal)}}' data-wholesale = '{{item.isWholesale}}'  data-sku='{{item.skuId}}' data-skuName='{{item.sku}}' data-goodsId='{{item.goodsId}}'
		data-goodsVersion='{{item.goodsVersion}}'>
		<div class="cart_del" data-line-id="{{item.skuId}}"></div>
		{{# if (item.mainImg && item.mainImg != '' && Object.prototype.toString.call(item.mainImg).slice(8,-1) != 'Null') { }}
		<a href="productDetail_{{item.goodsId}}.html" class="cart_img" data-img="{{returnSuffixName(item.mainImg)}}">
			<img src="{{returnSuffixName(item.mainImg)}}" alt="{{item.goodsName}}">
			{{# if(item.discountPrice && item.discountPrice < item.sellingPrice){ }} <div class="off">
				<em><i>{{parseFloat(Math.floor(100 - Number(item.discountPrice) / Number(item.sellingPrice) * 100))}}</i>%</em>
				<em>RABAIS</em>
				</div>
				{{# } }}
		</a>
		{{# } else { }}
		<a href="productDetail_{{item.goodsId}}.html" class="cart_img">
			<img src="../assets/wap/images/BitmapPerson.png" alt="{{item.goodsName}}">
			{{# if(item.discountPrice && item.discountPrice < item.sellingPrice){ }} <div class="off">
				<em><i>{{parseFloat(Math.floor(100 - Number(item.discountPrice) / Number(item.sellingPrice) * 100))}}</i>%</em>
				<em>RABAIS</em>
				</div>
				{{# } }}
		</a>
		{{# } }}
		<div class="cart_info">
			<div class="cart_product--name font_overhide">{{item.goodsName}}</div>
			<div class="cart_product--skuVal">
				{{# if(item.speType == 1 ){ }}
				<div class='skuVal'>
					{{# layui.each(JSON.parse(item.skuVal), function(index, element){ }}
				{{# if(element.hasOwnProperty('speValmainImg') && element.speValmainImg !='' &&
				Object.prototype.toString.call(element.speValmainImg).slice(8, -1) != 'Null' ){ }}
					<p><span>{{element.spe}}</span> <i>:</i><span data-img="{{returnSuffixName(element.speValmainImg)}}"
							data-zoom="zoomImg" class="skuValImg"></span></p>
					{{# }else{ }}
					<p><span>{{element.spe}}</span><i>:</i><span>{{element.speVal}}</span></p>
					{{# } }}
					{{# }) }}
				</div>
				{{# }else if(item.speType == 2 || item.speType == 3 ){ }}
					<div class='skuVal'>
						{{# layui.each(JSON.parse(item.customVal), function(index, element){ }}
							{{# if(element.type === '2' || element.type === '4'){ }}
								{{# if( element.value != '' &&  element.value != null){ }}
									<!-- <p><span>{{element.name}}</span> <i>:</i><span data-img="{{returnSuffixName(element.value)}}"
										data-zoom="zoomImg" class="skuValImg"></span></p> -->
										{{# if(element.type === '2') { }}
										<p><span>{{element.name}}</span> <i>:</i><span data-img="{{returnSuffixName(element.value)}}" data-zoom="zoomImg"
												class="skuValImg"></span></p>
										{{# }else{ }}
										<p><span>{{element.name}}</span> <i>:</i><span data-img="{{element.value}}" data-zoom="zoomImg"
												class="skuValImg"></span></p>
										{{# } }}
								{{# } }}
							{{# }else{ }}
								<p><span>{{element.name}}</span><i>:</i><span>{{element.value}}</span></p>
							{{# } }}
							{{# if(element.hasOwnProperty("childList")) {}}
								{{# layui.each(element.childList, function(index, item){}}
									{{# if(item.type === '2' || item.type === '4'){ }}
										{{# if(item.value != '' &&  item.value != null ){}}
											<!-- <p><span>{{item.name}}</span> <i>:</i><span data-img="{{returnSuffixName(item.value)}}"
												data-zoom="zoomImg" class="skuValImg"></span></p> -->
												{{# if(item.type === '2') { }}
												<p><span>{{item.name}}</span> <i>:</i><span data-img="{{returnSuffixName(item.value)}}" data-zoom="zoomImg"
														class="skuValImg"></span></p>
												{{# }else{ }}
												<p><span>{{item.name}}</span> <i>:</i><span data-img="{{item.value}}" data-zoom="zoomImg"
														class="skuValImg"></span></p>
												{{# } }}
										{{# } }}
									{{# }else{ }}
										<p><span>{{item.name}}</span><i>:</i><span>{{item.value}}</span></p>
									{{# } }}
								{{# }) }}
							{{# } }}
							{{# if(element.creationId){ }}
							 <p>Customize :<img src="{{element.image}}" data-id="{{element.creationId}}" class="toThreeD" alt=""></p>
							{{# } }}
						{{# }) }}
					</div>
				{{# }}}
			</div>
			<div class="cart_price">
				{{# if (item.sellingPrice && item.sellingPrice != '' && Object.prototype.toString.call(item.sellingPrice).slice(8, -1)
				!= 'Null' && Number(item.sellingPrice) > Number(item.discountPrice) ) { }}
				<span class="cart_price--compare" data-money="{{item.sellingPrice}}"></span>
				<span class="cart_price--discountPrice" data-money='{{item.discountPrice}}'></span>
				{{# } else { }}
				<span class="cart_price--discountPrice" data-money='{{item.discountPrice}}'></span>
				{{# } }}
			</div>
			<div class="quantity-selector">
				<button type="button" class="quantity-selector__button" data-action="decrease-quantity"
					data-id="{{item.speType}}" title="Decrease quantity by 1"></button>
				<input class="quantity-selector__value" pattern="[0-9]*" value="{{item.quantity}}" size="2"
					data-id="{{item.speType}}" data-line-id="{{item.skuId}}">
				<button type="button" class="quantity-selector__button" data-action="increase-quantity"
					data-id="{{item.speType}}" title="Increase quantity by 1"></button>
			</div>
		</div>
	</li>

	{{# }) }}
	{{# if(d.invalidGoodsList.length){ }}
		{{# layui.each(d.invalidGoodsList, function(index, item){ }}
			<li class="expired" data-customVal='{{$.base64.encode(item.customVal)}}' data-sku='{{item.skuId}}'
				data-goodsId='{{item.goodsId}}' data-goodsVersion='{{item.goodsVersion}}'  data-skuName='{{item.sku}}' >
				<div class="cart_del"></div>
				<div class="cart_img" data-img="{{returnSuffixName(item.mainImg||'')}}">
					<img src="{{returnSuffixName(item.mainImg||'')}}" alt="{{item.goodsName}}">
				</div>
				<input class="quantity-selector__value" type='hidden' value="{{item.quantity}}" size="2" data-id="{{item.speType}}"
					data-line-id="{{item.skuId}}">
				<div class="cart_info">
					<div class="cart_product--name font_overhide">{{item.goodsName}}</div>
					
				</div>
			</li>
		{{# }) }}
	{{# } }}
</script>
<!-- 运费 -->
<script id="shipping_template" type="text/html">
    {{# if(d.length){ }}
    <div class="cart-section">
      <div class="cart-section--title" data-action="toggle-collapsible">
        <span>MODE DE LIVRAISON</span>
        <i></i>
      </div>
      <div class="cart-section--content">
    <ul class="shippingMethod-ul radio-ul">
      {{# layui.each(d, function(index, item){ }}
    <li class="radio-wrapper" data-id={{item.id}} data-name={{item.name}} >
      <label class="radio__label" for="shippingMethod-list-{{index}}">
        <div class="radio__input">
          <input class="input-radio"  type="radio" value="false" id="shippingMethod-list-{{index}}">
        </div>
        <span>
        {{item.name}}
        {{# if(item.displayPage && item.displayPage.indexOf("0") !== -1 && item.deliveryTime !=''){ }}
          ({{item.deliveryTime}})
        {{#} }}</span>
      </label>
      <div class="shippingCost" data-money='{{item.money}}'></div>
    </li>
    {{# }); }}
  </ul>
        <div id='shipping'></div>
      </div>
    </div>
        {{# } }}
</script>
<!-- 费用明细 -->
<script id='total_template' type="text/html">
    <ul>
  <li>
    <span>Prix du produit:</span>
    <span data-o-money='{{d.productPrice}}'>{{d.symbol}}{{d.productPrice}}</span>
  </li>
  {{# if(d.dicountTotal > 0) {}}
  <li>
    <span>Remise:</span>
    <span data-money='{{ (d.promotionDiscount * 100 + d.couponDiscount * 100) / 100}}'></span>
  </li>
  {{# }}}
  <li>
      <span>Frais de port:</span>
      <span id='shipping_price'></span>
    </li>
    <li>
      <span>Le total:</span>
      <span id="total_price" data-o-money="{{d.total}}" data-d-money="{{d.total}}">{{d.symbol}}{{d.total}}</span>
    </li>
</ul>
  </script>
<!-- 优惠卷 -->
<script id="coupon_tempalte" type="text/html">
  {{# if(d.couponList.length){ }}
    <div class="cart-section">
      <div class="cart-section--title" data-action="toggle-collapsible">
        <span>Sélectionnez votre coupon</span>
      </div>
      <div class="cart-section--content">
        <ul class="cart_coupon">
    {{# layui.each(d.couponList, function(index, item){ }}
    {{# if(item.isValid == '0'){ }}
    <li class="cart_coupon--cell" data-discount-id='{{item.id}}' data-exclude='{{item.addFoldUp}}'>
      {{# if(item.ruleResult == '1'){ }}
      <div>
        <span>{{item.ruleDesc}}</span>
        <p>RABAIS</p>
      </div>
      {{# }else if(item.ruleResult == '0') { }}
      <div>
        <!-- <i>{{d.symbol}}</i> -->
        <span class='minus'>- </span>
        <span data-money='{{item.ruleDesc}}'></span>
      </div>
      {{# }}}
    </li>
    {{# }else if(item.difference > 0){ }}
    <li class='discount-gray_cell' data-discount-id='{{item.id}}' data-exclude='{{item.addFoldUp}}'>
      <div>
        {{# if(item.ruleResult == '1'){ }}
        <div class='discountCard'>
          <span>{{item.ruleDesc}}</span>
          <p>RABAIS</p>
        </div>
        {{# }else if(item.ruleResult == '0') { }}
        <div class='discountCard'>
          <!-- <i>{{d.symbol}}</i> -->
          <span class='minus'>- </span>
          <span data-money='{{item.ruleDesc}}'></span>
        </div>
        {{# }}}
        <div class='cart-progress'>
          {{# if(item.activitiesRule == '2'){ }}
          <span>{{item.difference}} PCS Suite</span>
          {{# }else{}}
          <span> <i data-money='{{item.difference}}'></i>
            <!-- {{d.symbol}} -->
            Suite</span>
          {{# }}}
          <div class="layui-progress">
            <div class="layui-progress-bar" style="width:{{item.proportion}};background:#EFC892"></div>
          </div>
        </div>
      </div>
    </li>
    {{# }}}
    {{# }); }}
        </ul>
      </div>
    </div>
    <div class="shopcart-or"><span>OR</span></div>
    {{# }}}
  </script>
<!-- 全场活动 -->
<script id="promotionTpl" type="text/html">
         {{# if(d.length){ }}
        <div class="cart-section">
            <div class="cart-section--title" data-action="toggle-collapsible">
              <span>REMISE PROMOTIONNELLE</span>
              <i></i>
            </div>
            <div class="cart-section--content">
              <ul class="promotion-ul radio-ul">
                {{# layui.each(d, function(index, item){  }}
            <li class="radio-wrapper "  data-id="{{item.id}}" data-exclude='{{item.addFoldUp}}'>
                  <label class="radio__label" for="promotion-list-01">
                    <div class="radio__input">
                      <input class="input-radio" type="radio" value="false" id="promotion-list-{{index}}">
                </div>
                      <span>{{ item.name }}
                        {{# if(item.start != null && item.end != null){ }}
                         ( <em class='promotion_start'>{{item.start.split(' ')[0]}}</em><em class='promotion_end'>{{item.end.split(' ')[0]}}</em> )
                         {{# } }}<span></span></span>
              </label>
            </li>
                {{# }) }}
                  <li class="radio-wrapper" data-value='0' data-id='no_promotion' data-exclude='1'>
                    <label class="radio__label" for="promotion-list-02">
                      <div class="radio__input">
                        <input class="input-radio" type="radio" value="false" id="promotion-list-02">
                </div>
                        <span>Non merci<span></span></span>
              </label>
            </li>
          </ul>
        </div>
      </div>
      {{# } }}
      </script>
{% endraw %}
{% endblock %}